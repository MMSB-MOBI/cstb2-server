(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0ba6f8"],{"36cb":function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"result_page",(function(){return i}));var r=n("09d6");"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof e||"undefined"!==typeof self&&self;function o(e,t){return t={exports:{}},e(t,t.exports),t.exports}var s=o((function(e,t){(function(t,n){e.exports=n()})(0,(function(){return function e(t,n,r){var o,s,a=window,i="application/octet-stream",c=r||i,d=t,l=!n&&!r&&d,u=document.createElement("a"),g=function(e){return String(e)},f=a.Blob||a.MozBlob||a.WebKitBlob||g,p=n||"download";if(f=f.call?f.bind(a):Blob,"true"===String(this)&&(d=[d,c],c=d[0],d=d[1]),l&&l.length<2048&&(p=l.split("/").pop().split("?")[0],u.href=l,-1!==u.href.indexOf(l))){var h=new XMLHttpRequest;return h.open("GET",l,!0),h.responseType="blob",h.onload=function(t){e(t.target.response,p,i)},setTimeout((function(){h.send()}),0),h}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(d)){if(!(d.length>2096103.424&&f!==g))return navigator.msSaveBlob?navigator.msSaveBlob(v(d),p):w(d);d=v(d),c=d.type||i}else if(/([\x80-\xff])/.test(d)){var b=0,m=new Uint8Array(d.length),_=m.length;for(b;b<_;++b)m[b]=d.charCodeAt(b);d=new f([m],{type:c})}function v(e){var t=e.split(/[:;,]/),n=t[1],r="base64"==t[2]?atob:decodeURIComponent,o=r(t.pop()),s=o.length,a=0,i=new Uint8Array(s);for(a;a<s;++a)i[a]=o.charCodeAt(a);return new f([i],{type:n})}function w(e,t){if("download"in u)return u.href=e,u.setAttribute("download",p),u.className="download-js-link",u.innerHTML="downloading...",u.style.display="none",document.body.appendChild(u),setTimeout((function(){u.click(),document.body.removeChild(u),!0===t&&setTimeout((function(){a.URL.revokeObjectURL(u.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,i)),window.open(e)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=e),!0;var n=document.createElement("iframe");document.body.appendChild(n),!t&&/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,i)),n.src=e,setTimeout((function(){document.body.removeChild(n)}),333)}if(o=d instanceof f?d:new f([d],{type:c}),navigator.msSaveBlob)return navigator.msSaveBlob(o,p);if(a.URL)w(a.URL.createObjectURL(o),!0);else{if("string"===typeof o||o.constructor===g)try{return w("data:"+c+";base64,"+a.btoa(o))}catch(j){return w("data:"+c+","+encodeURIComponent(o))}s=new FileReader,s.onload=function(e){w(this.result)},s.readAsDataURL(o)}return!0}}))})),a='.root.sc-result-page{display:grid;padding:1rem 2rem;-webkit-box-sizing:border-box;box-sizing:border-box;grid-template-columns:-webkit-min-content auto;grid-template-columns:min-content auto;grid-column-gap:5rem;grid-row-gap:1rem;cursor:default;font-family:"Helvetica Neue", Helvetica, Arial;grid-template-areas:"header header"\n  "table graphic"}.header.sc-result-page{grid-area:header}.table.sc-result-page{grid-area:table}.right-pannel.sc-result-page{grid-area:graphic}.first-line.sc-result-page{display:grid;grid-template-columns:-webkit-min-content auto;grid-template-columns:min-content auto;grid-column-gap:1em;height:-webkit-max-content;height:-moz-max-content;height:max-content}.genome-rep.sc-result-page{display:grid;grid-template-columns:auto 30em}.legend.sc-result-page{padding-top:10em}.log-info.sc-result-page{background-color:#c6ecc6;border:solid;border-width:1px;border-color:green}.log-info-content.sc-result-page{display:grid;grid-template-columns:-webkit-max-content auto;grid-template-columns:max-content auto;grid-column-gap:2em;padding:0.5em}.log-info-header.sc-result-page{display:-ms-flexbox;display:flex;padding:0.5em}.log-info-header.open.sc-result-page{background-color:#37ae37}.log-info-header.sc-result-page:hover{background-color:#37ae37;cursor:pointer}.log-info-header.sc-result-page>i.sc-result-page{-ms-flex-align:center;align-items:center}.first-col.sc-result-page{display:grid}.excluded-list.sc-result-page{padding:0.4em;overflow:auto;height:6vh;border:solid;border-color:green;border-width:1px;border-radius:5px;background-color:#ecf9ec}.sc-result-page::-webkit-scrollbar{width:10px}.sc-result-page::-webkit-scrollbar-thumb{-webkit-box-shadow:inset 0 0 10px 10px grey;box-shadow:inset 0 0 10px 10px grey;border:solid 2px transparent;border-radius:7px}.download.sc-result-page{margin-top:1em;border:solid;padding:0.5em;width:-webkit-max-content;width:-moz-max-content;width:max-content;background-color:#cccccc !important;border-radius:3px;border-width:1px;border-color:#808080}.download.sc-result-page:hover{background-color:#bfbfbf !important}',i=function(){function e(e){Object(r["f"])(this,e),this.shouldHighlight=!1,this.selected={org:void 0,sgrna:void 0,ref:void 0,size:void 0,fasta_header:void 0},this.current_references=[],this.current_sgrnas=[],this.select_card=[],this.display_log=!1}return e.prototype.action=function(){this.shouldHighlight=!0},e.prototype.componentWillLoad=function(){this.sequence_data_json=this.loadSequenceData(),this.organism_data=this.formatOrganismData(),this.fasta_metadata_json="object"===typeof this.fasta_metadata?this.fasta_metadata:JSON.parse(this.fasta_metadata),this.organisms=this.org_names.split("&"),this.excluded_genomes=this.excluded_names.split("&"),void 0!==this.gene&&(this.gene_json=this.loadGenes())},e.prototype.loadSequenceData=function(){var e="object"===typeof this.complete_data?this.complete_data:JSON.parse(this.complete_data);return e.forEach((function(e){return e.occurences.forEach((function(e){return e.all_ref.forEach((function(e){return e.coords=Object.values(e.coords)}))}))})),e},e.prototype.loadGenes=function(){var e=this.gene&&"object"===typeof this.gene?this.gene:JSON.parse(this.gene);return Object.values(e).forEach((function(e){var t=0;Object.values(e).forEach((function(e){e.map((function(e){t+=1,e.gene_number=t}))}))})),e},e.prototype.formatOrganismData=function(){var e=this.all_data&&"object"===typeof this.all_data?this.all_data:JSON.parse(this.all_data);return Object.entries(e).map((function(e){var t=e[0];return{organism:t,fasta_entry:Object.entries(e[1]).map((function(e){return{ref:e[0],sgrna:Object.entries(e[1]).map((function(e){return{seq:e[0],coords:Object.values(e[1].coords),on_gene:e[1].on_gene?Object.values(e[1].on_gene):void 0,not_on_gene:e[1].not_on_gene?Object.values(e[1].not_on_gene):void 0}}))}}))}}))},e.prototype.getReferences=function(e){return this.organism_data.find((function(t){return t.organism===e})).fasta_entry.map((function(e){return e.ref}))},e.prototype.getReferencesWithSeq=function(e,t){return this.sequence_data_json.find((function(e){return e.sequence===t})).occurences.find((function(t){return t.org===e})).all_ref.map((function(e){return e.ref}))},e.prototype.getSgrnas=function(e,t,n){var r=this.organism_data.find((function(t){return t.organism===e})).fasta_entry.find((function(e){return e.ref===t})).sgrna;if(n){var o=new Set(n);r=r.filter((function(e){return o.has(e.seq)}))}return r},e.prototype.getSize=function(e,t){return this.fasta_metadata_json.find((function(n){return n.org===e&&n.fasta_ref===t})).size},e.prototype.getHiddenReferences=function(e){var t=this.getReferences(e),n=this.fasta_metadata_json.filter((function(t){return t.org===e})).map((function(e){return e.fasta_ref})),r=n.filter((function(e){return!t.includes(e)}));return r},e.prototype.getFastaHeader=function(e,t){var n=this.fasta_metadata_json.find((function(n){return n.org===e&&n.fasta_ref===t})).header;return n},e.prototype.getGenesCoordinates=function(e,t){return this.gene_json[e][t]},e.prototype.getCoordinates=function(e){return this.current_sgrnas.find((function(t){return t.seq===e})).coords.map((function(e){return e.coord}))},Object.defineProperty(e.prototype,"all_start_coordinates",{get:function(){var e=[];return this.current_sgrnas.forEach((function(t){return t.coords.forEach((function(t){return e.push(parseInt(/\(([0-9]*),/.exec(t.coord)[1]))}))})),e.sort((function(e,t){return e-t}))},enumerable:!0,configurable:!0}),e.prototype.isCompleteSelection=function(){return!Object.values(this.selected).includes(void 0)},e.prototype.addToCard=function(e){var t=this.select_card.concat(e);this.select_card=t.filter((function(e,n){return t.indexOf(e)===n}))},e.prototype.removeFromCard=function(e){this.select_card=this.select_card.filter((function(t){return!e.includes(t)}))},e.prototype.createSelectionFile=function(){var e=this;if(this.select_card.length){var t=this.sequence_data_json.filter((function(t){return e.select_card.includes(t.sequence)})),n=this.gene_json?"#sgRNA\torganism\tfasta record\tcoordinates\tinside homologous gene\n":"#sgRNA\torganism\tfasta record\tcoordinates\n";t.forEach((function(t){t.occurences.forEach((function(r){r.all_ref.forEach((function(o){o.coords.forEach((function(s){n=n+(t.sequence+"\t")+r.org+"\t"+o.ref+"\t"+s.coord,e.gene_json&&(n=n+"\t"+(s.is_on_gene.length?"true":"false")),n+="\n"}))}))}))})),s(n,this.job_tag+"_selected_sgrnas.tsv","text/plain")}else window.alert("No sgRNA selected")},e.prototype.displayCard=function(){if(this.isCompleteSelection()){var e=this.getCoordinates(this.selected.sgrna);return Object(r["e"])("div",{class:"genomic-card"},Object(r["e"])("div",{class:"genome-rep"},Object(r["e"])("circular-barplot",{list_coordinates:this.all_start_coordinates,genome_size:this.selected.size,selected_sgrna_coordinates:e,gene_coordinates:this.current_genes,active_rotation:!0}),Object(r["e"])("div",{class:"legend"},Object(r["e"])("circular-barplot-legend",{gene:!!this.current_genes}))))}return Object(r["e"])("div",{class:"genomic-card"})},e.prototype.displayCoords=function(){return this.isCompleteSelection()?Object(r["e"])("div",{class:"coords"},Object(r["e"])("coord-box",{selected:this.selected,current_sgrnas:this.current_sgrnas,current_genes:this.current_genes})):Object(r["e"])("div",{class:"coords"})},e.prototype.overflowGestion=function(){if(document.querySelector(".excluded-list").scrollHeight>document.querySelector(".excluded-list").clientHeight)return Object(r["e"])("div",{class:"show-all-eg"}," ",Object(r["e"])("i",{class:"material-icons"},"arrow_drop_down")," ")},e.prototype.displayExcluded=function(){return""===this.excluded_genomes[0]?Object(r["e"])("span",null," No excluded genomes"):[Object(r["e"])("span",null,"Excluded genomes "),Object(r["e"])("div",{class:"excluded-list"}," ",this.excluded_genomes.join(";")," ")]},e.prototype.render=function(){var e=this;return window.result_page=this,Object(r["e"])("div",{class:"root"},Object(r["e"])("div",{class:"header"},Object(r["e"])("div",{class:"log-info"},Object(r["e"])("div",{class:"log-info-header"+(this.display_log?" open":""),onClick:function(){return e.display_log=!e.display_log}},Object(r["e"])("span",null," Job info ")," ",Object(r["e"])("i",{class:"material-icons"},this.display_log?"arrow_drop_up":"arrow_drop_down")),Object(r["e"])("div",{class:"log-info-content",style:{display:this.display_log?"grid":"none"}},Object(r["e"])("div",{class:"first-col"},Object(r["e"])("span",null,"Job id : ",this.job_tag),Object(r["e"])("span",null,"Total hits : ",this.total_hits),Object(r["e"])("span",null,"Displayed hits : ",this.sequence_data_json.length)),Object(r["e"])("div",{class:"second-col"},this.displayExcluded()))),Object(r["e"])("div",{class:"download w3-dropdown-hover"},Object(r["e"])("span",{class:"download-dropdown-header"}," Download results"),Object(r["e"])("div",{class:"w3-dropdown-content w3-bar-block w3-border"},Object(r["e"])("a",{href:"download/"+this.job_tag,class:"w3-bar-item w3-button"},"All raw results"),Object(r["e"])("a",{href:"#",class:"w3-bar-item w3-button",onClick:function(){return e.createSelectionFile()}},"Selected sgRNAs")))),Object(r["e"])("div",{class:"table"},Object(r["e"])("table-crispr",{card_selection:this.select_card,selected:this.selected,complete_data:this.sequence_data_json,onOrganismClick:function(t,n){e.current_references=e.getReferencesWithSeq(t,n);var r=e.current_references[0];e.current_sgrnas=e.getSgrnas(t,r),e.selected={org:t,sgrna:n,ref:r,size:e.getSize(t,r),fasta_header:e.getFastaHeader(t,r)},e.shouldHighlight=!0,e.initial_sgrnas=e.current_sgrnas,e.current_genes=e.gene_json?e.getGenesCoordinates(t,r):void 0},shouldHighlight:this.shouldHighlight,gene:!!this.gene_json,reinitSelection:function(){e.current_references=[],e.current_sgrnas=[],e.selected={org:void 0,sgrna:void 0,ref:void 0,size:void 0,fasta_header:void 0}},cardAction:function(t,n){t.checked?e.addToCard(n):e.removeFromCard(n)}})),Object(r["e"])("div",{class:"right-panel"},Object(r["e"])("div",{class:"first-line"},Object(r["e"])("dropdown-menu",{organisms:this.organisms,fasta_refs:this.current_references,sgrnas:this.current_sgrnas,selected:this.selected,selectOrg:function(t){e.shouldHighlight=!1,e.current_references=e.getReferences(t),e.current_sgrnas=[],e.selected={org:t,sgrna:void 0,ref:void 0,size:void 0,fasta_header:void 0}},selectRef:function(t){e.current_sgrnas=e.getSgrnas(e.selected.org,t),e.current_genes=e.gene_json?e.getGenesCoordinates(e.selected.org,t):void 0,e.shouldHighlight=!1,e.selected=Object.assign(Object.assign({},e.selected),{sgrna:void 0,ref:t,size:void 0,fasta_header:void 0})},selectSgrna:function(t){e.shouldHighlight=!1,e.selected=Object.assign(Object.assign({},e.selected),{sgrna:t,size:e.getSize(e.selected.org,e.selected.ref),fasta_header:e.getFastaHeader(e.selected.org,e.selected.ref)})}}),this.displayCoords()),this.displayCard()))},e}();i.style=a}.call(this,n("c8ba"))}}]);
//# sourceMappingURL=chunk-2d0ba6f8.6d5c189f.js.map